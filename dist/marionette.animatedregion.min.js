/*! marionette.animatedregion - v0.3.4
 *  Release on: 2016-11-18
 *  Copyright (c) 2016 StÃ©phane Bachelier
 *  Licensed MIT */
!function(a,b){"function"==typeof define&&define.amd?define(["backbone.marionette","lodash","motioncontrol.js"],function(c,d,e){return a.AnimatedRegion=b(c,d,e)}):"object"==typeof exports?module.exports=b(require("backbone.marionette"),require("lodash"),require("motioncontrol.js")):a.AnimatedRegion=b(Marionette,_,motioncontrol)}(this,function(a,b,c){"use strict";var d=require("raf"),e=a.Region.extend({attachHtml:function(c){var d=new MutationObserver(b.bind(function(){d.disconnect(),this.animateView(c,"in")},this)),e={attributes:!1,childList:!0,characterData:!1};d.observe(this.el,e),this.isViewSupportingAnimation=!b.isEmpty(c.animationClassName),a.Region.prototype.attachHtml.call(this,c)},empty:function(){var a=this.currentView;if(!a)return this;var c=this.animateView(a,"out");return!1===c?(this.triggerMethod("empty"),this):c.then(b.bind(function(){this.triggerMethod("empty")},this))},animateView:function(a,d){d=d||"in";var e={trigger:b.bind(b.partial(this.launchAnimation,a,d),this)},f=b.extend(e,b.result(this,"getAnimationOptions"));this.triggerMethod("animate:view:"+d,a),a.triggerMethod("animate:"+d);var g=this;return c(a.el,f).then(function(){g.isViewSupportingAnimation&&(g.triggerMethod("animated:view:"+d,a),a.triggerMethod("animated:"+d))})},launchAnimation:function(a,c){var d="animateView"+c.charAt(0).toUpperCase()+c.substring(1),e=this[d];return this.isViewSupportingAnimation&&b.isFunction(e)?e.call(this,a):this.isViewSupportingAnimation},animateViewIn:function(a){a.animationClassName["in"]&&this.updateClassList(a.el,a.animationClassName["in"],"add")&&this.triggerMethod("animating:view:in")},onAnimatedViewIn:function(a){a.animationClassName.out&&this.updateClassList(a.el,a.animationClassName["in"],"remove")},animateViewOut:function(a){a.animationClassName["in"]&&this.updateClassList(a.el,a.animationClassName.out,"add")&&this.triggerMethod("animating:view:out")},onAnimatedViewOut:function(a){a.animationClassName.out&&this.updateClassList(a.el,a.animationClassName.out,"remove")},updateClassList:function(a,b,c){if(a&&b&&c){var e=a.classList[c];if(!e)return!1;var f=b?b.split(" "):[];return d(function g(){for(var b=0,e=f.length;e>b;b+=1)a.classList[c](f[b]);d(g)}),!0}}});return e.extend=a.extend,a.AnimatedRegion=e,e});